#: import Factory kivy.factory.Factory

<FotoPerfil@BoxLayout>:
    size_hint: None, None
    size: dp(100), dp(100)  # Puedes ajustar este tamaño según necesites
    pos_hint: {'center_x': .5, 'center_y': .5}
    imagen: None
    
    StencilView:
        size_hint: None, None
        size: root.size
        
        canvas.before:
            Color:
                rgba: 0,0,0,1
            Ellipse: 
                size: self.size
                pos: self.pos
            #Color:
            #    rgba: 1, 1, 1, 1
            #Ellipse:
            #    size: self.size[0]-2,self.size[1]-2
            #    pos: self.pos[0]+1,self.pos[1]+1
        
        Image:
            size_hint: None, None
            size: root.size[0]-2,root.size[1]-2
            source: root.imagen if root.imagen else None
            allow_stretch: True
            keep_ratio: False
            #pos: self.parent.pos[0]+1,self.parent.pos[1]+1


<Menu_Cuenta@ModalView>:
    # Configuración de tu ModalView
    size_hint: 0.9, 0.5
    
    auto_dismiss: True
    login:None
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        Label:
            text: '¿Desea Cerrar la sesión?'
            halign: 'center'
            valign: 'center'
            size_hint: (1,1)
            font_size: sp(25)
            text_size: (self.width,None)

        BoxLayout:
            orientation: 'horizontal' 
            size_hint: (0.8,None)
            height: dp(45)
            pos_hint: {'center_x':0.5}
            Button:
                text: 'Aceptar'
                size_hint_y: None
                height: 48
                # Llama al método dismiss() de la instancia del ModalView
                on_release: root.dismiss(); root.login() if root.login() else None
            Button:
                text: 'Denegar'
                size_hint_y: None
                height: 48
                # Llama al método dismiss() de la instancia del ModalView
                on_release: root.dismiss()


<Boton_Cuenta@ButtonBehavior+BoxLayout>:
    orientation: 'vertical'
    perfil: "Sin Perfil"
    imagen: None
    nombre: "Sin Nombre"
    apellido: "Sin Apellido"
    canvas.before:
        Color:
            rgba: 0.9,0.9,0.9,1
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,1)
        #width: self.minimum_width
        pos_hint: {'center_x':0.5}
        
        Label:
            text: root.perfil
            font_size: sp(20)
            size_hint: (1,None)
            height: self.font_size
            canvas.before:
                Color: 
                    rgba:1,0.7,0.7,1
                Rectangle: 
                    size:self.size
                    pos:self.pos

        FotoPerfil:
            size_hint: (None,1)
            width: self.height
            imagen:root.imagen
        
        Label:
            text: root.nombre
            font_size: sp(20)
            size_hint: (1,None)
            height: self.font_size
            canvas.before:
                Color: 
                    rgba:1,0.7,0.7,1
                Rectangle: 
                    size:self.size
                    pos:self.pos
        Label:
            text: root.apellido
            font_size: sp(20)
            size_hint: (1,None)
            height: self.font_size
            canvas.before:
                Color: 
                    rgba:1,0.7,0.7,1
                Rectangle: 
                    size:self.size
                    pos:self.pos



<Layout_Estandar>:
    orientation: 'vertical'
    size_hint: (1,1)
    padding: dp(10)
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            size: self.size
            pos: self.pos
    Boton_Cuenta:
        size_hint: (1,0.2)
        perfil: "Usuario Estandar"
        nombre: "Nombrerito"
        apellido: "apellido"
        
        
            
    
    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.6)
        canvas.before:
            Color:
                rgba: 0,0,0,1
            Rectangle:
                size:self.size
                pos: self.pos
            Color:
                rgba: 0.95, 0.9,0.9,1
            Rectangle:
                size:self.size[0]-dp(4),self.size[1]-dp(4)
                pos:self.pos[0]+dp(2),self.pos[1]+dp(2)
        ScrollView:
            do_scroll_x: False
            do_scroll_y: True
            scroll_y: 1
            size_hint: (1,1)
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
                spacing: dp(5)
                Button:
                    text: "Mapa"
                    size_hint: (1,None)
                    height: dp(45)
                    on_release: root.Abrir_Mapa()
                Button:
                    text: "Eventos Favoritos"
                    size_hint: (1,None)
                    height: dp(45)
                    on_release: root.Abrir_EventosFavoritos()
                Button:
                    text: "Cupones"
                    size_hint: (1,None)
                    height: dp(45)
                Button:
                    text: "Suscripciones"
                    size_hint: (1,None)
                    height: dp(45)
                Button:
                    text: "Configuración"
                    size_hint: (1,None)
                    height: dp(45)
    BoxLayout:
        orientation: 'horizontal'
        size_hint: (1,None)
        height: dp(45)
        Button:
            text: 'Cerrar Sesión'
            pos_hint: {"center_x":0.5}
            size: (0.4,1)
            on_release: Factory.Menu_Cuenta(login=root.Abrir_Login).open()


